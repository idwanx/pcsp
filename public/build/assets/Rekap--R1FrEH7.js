import{q as R,r,y as U,j as e,a as B}from"./app-WbhuZwgD.js";import{A as q}from"./App-wsL7-IOE.js";import{u as K,l as p}from"./usePrevious-HSY1OuaU.js";import O from"./SideBar-IGgQgGvq.js";import{S as T}from"./Select-bGoUyjkb.js";import{A as V}from"./ArrowLeftCircleIcon-h1rP4nYp.js";import{U as S}from"./UsersIcon-z2f_jNmz.js";import{U as J}from"./UserCircleIcon-k--mXj0a.js";import"./transition-7EqSnZ0P.js";import"./dialog-GskEfDqT.js";import"./XMarkIcon-5Vf4vcu0.js";import"./Bars3Icon-iRBVzc8J.js";import"./UserIcon-soVl5Kxn.js";import"./ResponsiveSideBarLink-S2oBWZRr.js";import"./ArrowRightIcon-b91TePHy.js";function M(){var _;const{partai:o,tahun:f,pemilu:j,filtered:d,partais:t,dapils:k,totalpemilih:$,hasil:i}=R().props,[g,N]=r.useState([]),[x,w]=r.useState(null),C=()=>{window.history.back()},m=i==null?void 0:i.flatMap(l=>[l.n1,l.n3,l.n5,l.n7,l.n9,l.n11]),u=m==null?void 0:m.sort((l,s)=>s.nilai-l.nilai),h=u==null?void 0:u.slice(0,6),D=h==null?void 0:h.reduce((l,s)=>{const{partai:n}=s;return l[n]||(l[n]=[]),l[n].push(s.logo),l},{});r.useEffect(()=>{if(x){async function l(){await fetch(route("rekapsuarapartai.getcalonpartai",{partai:x,tahun:f,pemilu:j.id,wilayah:d?d.wilayah:""})).then(s=>s.json()).then(s=>N(s.datacalon))}l()}},[x]);const a=$.reduce((l,s)=>l=l+s.total_pemilih,0),y=t.reduce((l,s)=>l=l+s.jumlah_suara,0),b=t.reduce((l,s)=>l=l+s.suara_partai,0),v=t.reduce((l,s)=>l=l+s.jumlah_suara+s.suara_partai,0),[c,I]=r.useState({wilayah:d.wilayah||""}),F=K(c),L=r.useCallback(p.debounce(l=>{U.get(route(route().current(),{partai:o,tahun:f,pemilu:j.id}),l,{replace:!0,preserveScroll:!0,preserveState:!0})},500),[]);r.useEffect(()=>{if(F){const l=Object.keys(p.pickBy(c)).length?p.pickBy(c):"";L(l)}},[c]);function P(l){const s=l.target.name,n=l.target.value;I(A=>({...A,[s]:n})),N([]),w(null)}const E=l=>{w(l)};return e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"Rekap Suara Partai"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 sm:gap-6",children:[e.jsx("div",{className:"hidden sm:w-1/5 lg:block md:hidden",children:e.jsxs("div",{className:"space-y-4 -mt-12 pt-12 lg:sticky lg:top-8 lg:col-start-2 lg:row-span-2 lg:row-start-1 lg:overflow-hidden",children:[e.jsx(O,{}),e.jsx("div",{className:"flex",children:e.jsx("div",{className:"relative w-full overscroll-auto",children:e.jsx("div",{className:"bg-white p-3 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"sticky top-0",children:e.jsx("p",{className:"text-md font-semibold text-gray-600",children:"Perolehan Kursi"})}),e.jsx("ul",{role:"list",className:"divide-y divide-gray-200",children:i.length>0&&v>0?(_=Object.entries(D))==null?void 0:_.map(([l,s])=>e.jsxs("li",{className:"flex py-3 items-center",children:[(s==null?void 0:s[0])==null?e.jsx("img",{className:"h-14 w-14 flex-none rounded-md bg-gray-50",src:"/images/no-camera.png",alt:""}):e.jsx("img",{className:"h-14 w-14 flex-none rounded-md bg-gray-50",src:`/storage/${s[0]}`,alt:""}),e.jsx("div",{className:"ml-4 flex flex-1 flex-col min-w-0",children:e.jsxs("div",{className:"min-w-0 flex-auto",children:[e.jsx("div",{className:"flex justify-between text-sm font-medium text-gray-600",children:e.jsx("h3",{children:l})}),e.jsxs("p",{className:"text-sm text-rose-600",children:[s.length," Kursi"]})]})})]},l)):e.jsx("div",{className:"text-gray-500",children:"Silahkan pilih dapil untuk melihat perolehan kursi partai."})})]})})})})]})}),e.jsx("div",{className:"w-full lg:w-4/5 sm:w-full",children:e.jsxs("div",{className:"flex lg:gap-6 sm:gap-2 lg:p-0 p-2",children:[e.jsx("div",{className:"w-full shrink-0 lg:w-2/3 md:w-2/3",children:e.jsxs("div",{className:"space-y-3 bg-white shadow-sm sm:rounded-lg text-sm p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"focus:outline-none text-base sm:text-lg md:text-xl lg:text-xl font-bold leading-normal text-gray-600",children:"Rekapitulasi Suara Partai"}),e.jsx("button",{type:"button",onClick:()=>C(),children:e.jsx(V,{className:"w-7 h-7 text-gray-400 hover:text-purple-500"})})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex items-center pt-4 justify-between w-full",children:[e.jsx("div",{className:"relative",children:e.jsxs(T,{id:"wilayah",name:"wilayah",className:"block w-full",value:c.wilayah,onChange:P,children:[e.jsx("option",{value:"",children:"Semua Dapil"}),k.map(l=>e.jsx("option",{value:l.id,children:l.nama_dapil},l.id))]})}),e.jsxs("div",{className:"flex tems-center text-base text-gray-600",children:["Total Pemilih: ",Number(a).toLocaleString("id-ID")]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full table-fixed",children:[e.jsx("thead",{className:"uppercase text-xs rounded-t-lg bg-gray-100",children:e.jsxs("tr",{className:"text-center font-semibold text-gray-600 border-b",children:[e.jsx("th",{style:{width:"5%"},className:"p-3 text-center",children:"No"}),e.jsx("th",{style:{width:"36%"},className:"p-3 text-left",children:"Nama Partai"}),e.jsx("th",{style:{width:"13%"},className:"p-3 text-center",children:"Suara Calon"}),e.jsx("th",{style:{width:"13%"},className:"p-3 text-center",children:"Suara Partai"}),e.jsx("th",{style:{width:"13%"},className:"p-3 text-center",children:"Jumlah"}),e.jsx("th",{style:{width:"10%"},className:"p-3 text-center",children:"%"}),e.jsx("th",{style:{width:"10%"},className:"p-3 text-center",children:"Calon"})]})}),e.jsxs("tbody",{className:"text-gray-500",children:[t==null?void 0:t.map((l,s)=>e.jsxs("tr",{className:"border-b border-opacity-20 hover:bg-slate-50",children:[e.jsx("td",{className:"px-3 py-2 text-center font-medium",children:s+1}),e.jsx("td",{className:"px-3 py-2 text-left",children:e.jsxs("div",{className:"flex min-w-0 gap-x-4 items-center",children:[l.logo==null?e.jsx("img",{className:"h-14 w-14 flex-none rounded-md bg-gray-50",src:"/images/no-camera.png",alt:""}):e.jsx("img",{className:"h-14 w-14 flex-none rounded-md bg-gray-50",src:`/storage/${l.logo}`,alt:""}),e.jsx("div",{className:"min-w-0 flex-auto",children:e.jsx("p",{className:"text-base text-gray-600 leading-6",children:l.nama_partai})})]})}),e.jsx("td",{className:"px-3 py-2 text-center",children:Number(l.jumlah_suara).toLocaleString("id-ID")}),e.jsx("td",{className:"px-3 py-2 text-center",children:l.suara_partai}),e.jsx("td",{className:"px-3 py-2 text-center",children:Number(l.jumlah_suara+l.suara_partai).toLocaleString("id-ID")}),e.jsxs("td",{className:"px-3 py-2 text-center",children:[parseFloat((l.jumlah_suara+l.suara_partai)/a*100).toFixed(2),"%"]}),e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx("button",{onClick:()=>E(l.alias),children:e.jsx(S,{className:"w-4 h-4 inline text-gray-600 -mt-0.5"})})})]},s)),e.jsxs("tr",{className:"border-b border-opacity-20 text-base font-semibold bg-slate-50",children:[e.jsx("td",{className:"px-3 py-2 text-center",colSpan:2,children:"Total"}),e.jsx("td",{className:"px-3 py-2 text-center",children:Number(y).toLocaleString("id-ID")}),e.jsx("td",{className:"px-3 py-2 text-center",children:Number(b).toLocaleString("id-ID")}),e.jsx("td",{className:"px-3 py-2 text-center",children:Number(v).toLocaleString("id-ID")}),e.jsxs("td",{className:"px-3 py-2 text-center",children:[parseFloat((y+b)/a*100).toFixed(2),"%"]}),e.jsx("td",{className:"px-3 py-2 text-center"})]})]})]})})]})}),e.jsx("div",{className:"hidden md:block lg:w-1/3 md:w-1/3",children:e.jsx("div",{className:"space-y-4 -mt-12 pt-12 lg:sticky lg:top-8 lg:col-start-2 lg:row-span-2 lg:row-start-1 lg:overflow-hidden",children:e.jsx("div",{className:"flex",children:e.jsx("div",{className:"relative w-full overscroll-auto",children:e.jsx("div",{className:"relative bg-white py-2 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("div",{className:"sticky top-0 px-4",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Daftar Calon"})}),e.jsx("hr",{className:"mt-2"}),e.jsx("div",{className:"lg:h-[34rem] 2xl:h-[44rem] overflow-x-hidden overflow-y-auto pt-4 px-4",children:e.jsx("ul",{role:"list",className:"divide-y divide-gray-200",children:g.length>0?g.map((l,s)=>e.jsxs("li",{className:"flex py-3 items-center",children:[l.foto==null?e.jsx(J,{className:"w-16 h-16 stroke-gray-400 stroke-1 inline -mt-0.5"}):e.jsx("img",{className:"h-16 w-16 flex-none rounded-full bg-gray-50",src:`/storage/${l.foto}`,alt:""}),e.jsxs("div",{className:"ml-4 flex flex-1 flex-col min-w-0",children:[e.jsxs("div",{className:"min-w-0 flex-auto",children:[e.jsx("div",{className:"flex justify-between text-md font-medium text-gray-600",children:e.jsx("h3",{className:"truncate max-w-readable",children:l.name})}),e.jsx("p",{className:"truncate text-xs text-gray-500 max-w-readable",children:l.nama_partai})]}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsx("div",{className:"flex justify-center w-1/5 text-lg font-medium mr-0.5 text-gray-600",children:l.calontpsuaras_count}),e.jsxs("div",{className:"flex justify-center w-4/5",children:[e.jsx("div",{className:"flex items-center w-4/6 mr-2.5",children:e.jsx("div",{className:"overflow-hidden bg-gray-200 h-1.5 rounded-full w-full",children:l.warna=="merah"?e.jsx("span",{className:"h-full bg-red-600 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}}):l.warna=="rose"?e.jsx("span",{className:"h-full bg-rose-600 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}}):l.warna=="hijau"?e.jsx("span",{className:"h-full bg-green-600 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}}):l.warna=="orange"?e.jsx("span",{className:"h-full bg-orange-600 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}}):l.warna=="kuning"?e.jsx("span",{className:"h-full bg-yellow-500 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}}):l.warna=="biru"?e.jsx("span",{className:"h-full bg-blue-600 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}}):l.warna=="biru-langit"?e.jsx("span",{className:"h-full bg-sky-500 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}}):l.warna=="biru-tua"?e.jsx("span",{className:"h-full bg-blue-800 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}}):l.warna=="hitam"?e.jsx("span",{className:"h-full bg-gray-800 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}}):e.jsx("span",{className:"h-full bg-red-600 w-full block rounded-full",style:{width:`${l.calontpsuaras_count/a*100+"%"}`}})})}),e.jsxs("div",{className:"flex justify-center w-2/6 text-lg font-medium text-gray-600",children:[l.calontpsuaras_count&&a!==0?parseFloat(l.calontpsuaras_count/a*100).toFixed(2):0,"%"]})]})]})]})]},s)):e.jsxs("div",{children:["Silahkan klik ikon ",e.jsx(S,{className:"w-4 h-4 inline text-gray-600 -mt-0.5"})," pada tabel untuk melihat calon."]})})})]})})})})})})]})})]})]})}M.layout=o=>e.jsx(q,{children:o});export{M as default};
